function pixelGlass() {

  'use strict';

  var doc = document;
  var controlsPanel;
  var bodyContentWrapper;
  var panelClass = 'controls-panel';
  var canBeDisabled = [];

  var prefix = 'pg';
  var filtersList = ['none', 'invert'];
  var statesList = ['off', 'on'];

  var currents = {
    state: getCurrent('state', statesList[1]),
    filter: getCurrent('filter', filtersList[0]),
    opacity: getCurrent('opacity', 0.5)
  };

  var targets = {
    state: {
      elem: doc.documentElement,
      attr: 'data'
    },
    filter: {
      elem: doc.body,
      attr: 'data'
    },
    opacity: {
      elem: doc.body,
      attr: 'style'
    }
  };

  // States switcher params
  var paramsStates = {
    elemTag: 'button',
    elemText: 'on',
    listName: 'states',
    itemName: 'state',
    target: targets.state,
    type: 'button',
    list: statesList,
    canDisableAll: true,
    attrs: {
      tabindex: 1,
    }
  };

  // Filters switcher params
  var paramsFilters = {
    elemTag: 'button',
    elemText: 'invert',
    listName: 'filters',
    itemName: 'filter',
    target: targets.filter,
    type: 'button',
    list: filtersList,
    attrs: {
      tabindex: 2,
    }
  };

  // Opacity range params
  var paramsOpacity = {
    itemName: 'opacity',
    type: 'number',
    target: targets.opacity,
    setAttr: 'style',
    attrs: {
      min: 0,
      max: 1,
      step: 0.1,
      tabindex: 3,
    }
  };

  //---------------------------------------------

  init();

  //---------------------------------------------

  function init() {
    createContolsPanel();
    applyCurrentData();

    if (currents.state === 'on'){
      applyCurrentStyles();
    }
  }

  //---------------------------------------------

  function createContolsPanel() {
    var targetElem = doc.documentElement;

    if ( hasData( doc.body, 'has-sticky-point' ) ) {
      var stickyPoint = doc.querySelector('.sticky-point');

      if( stickyPoint && !localStorage['pg-released'] ) {
        targetElem = stickyPoint;
      }
      // Override defaults for demo page
      currents.state = 'off';
    }

    controlsPanel = doc.createElement('div');
    controlsPanel.classList.add(panelClass);
    targetElem.appendChild(controlsPanel);
    var sides = ['top', 'right', 'bottom', 'left'];

    sides.forEach(function(item) {
      var itemVal = getCurrent(item, '');
      if ( itemVal ) {
        controlsPanel.style[ item ] = itemVal;
      }
    });

    initControls();
  }

  //---------------------------------------------

  function initControls() {
    createButton(paramsStates);
    createButton(paramsFilters);
    createInputNumber(paramsOpacity);

    createDragButton();
  }

  //---------------------------------------------

  function createButton(params) {
    var listName = params.listName;
    var itemName = params.itemName;
    var elemTag = params.elemTag;
    var elemText = params.elemText;
    var type = params.type;
    var list = params.list;
    var action = params.action;
    var currentVal = currents[itemName];
    var attrs = params.attrs;
    var currentNum = list.indexOf(currentVal);
    var canDisableAll = params.canDisableAll;

    var id = itemName;
    var input = doc.createElement(elemTag);
    setClasses( input, [
      panelClass + '__control',
      panelClass + '__control--' + type
    ]);
    input.setAttribute('type', type);
    input.setAttribute('id', id);
    setData( input, 'state-num', currentNum );

    if ( attrs ) {
      for (var attr in attrs) {
        input.setAttribute(attr, attrs[attr]);
      }
    }

    if (elemTag === 'button') {
      input.innerHTML = elemText;
    }

    if ( !canDisableAll ) {
      canBeDisabled.push(input);
    }

    controlsPanel.appendChild(input);

    input.onclick = function() {
      if (!params.target) {
        return;
      }

      currentNum = +!currentNum;
      currentVal = list[currentNum];

      setData( input, 'state-num', currentNum );
      setData( params.target.elem, itemName, currentVal );

      saveLocalStorage(itemName, currentVal);

      if (canDisableAll && canDisableAll === true) {
        if (currentVal === 'off'){
          removeCurrentStyles();
          disableInputs();
        }
        else {
          applyCurrentStyles();
          enableInputs();
        }
      }
    };
  }

  //---------------------------------------------

  function createInputNumber(params) {
    var itemName = params.itemName;
    var attrs = params.attrs;
    var type = params.type;
    var setAttr = params.setAttr;
    var canDisableAll = params.canDisableAll;

    var id = itemName;
    var input = doc.createElement('input');
    setClasses( input, [
      panelClass + '__control',
      panelClass + '__control--' + type
    ]);
    input.setAttribute('type', type);
    input.setAttribute('id', id);

    for (var attr in attrs) {
      input.setAttribute(attr, attrs[attr]);
    }
    input.setAttribute('value', currents[itemName]);

    if ( !canDisableAll ) {
      canBeDisabled.push(input);
    }

    controlsPanel.appendChild(input);

    input.oninput = function() {
      if (setAttr === 'style') {
        params.target.elem.style[itemName] = this.value;
        saveLocalStorage(itemName, this.value);
      }
    };
  }

  //---------------------------------------------

  function createDragButton() {
    var input = doc.createElement('button');
    setClasses( input, [
      panelClass + '__control',
      panelClass + '__control--drag-n-drop'
    ]);
    input.setAttribute('type', 'button');
    input.innerHTML = ' ';

    controlsPanel.appendChild(input);

    input.onmousedown = function () {
      //Place it here to get real sizes after
      // external styles has been loaded
      var offsetTop = this.offsetTop;
      var offsetLeft = controlsPanel.clientWidth - this.clientWidth;
      var styles = getComputedStyle(controlsPanel);

      controlsPanel.style.top = styles.top;
      controlsPanel.style.left = styles.left;
      controlsPanel.style.right = 'auto';
      controlsPanel.style.bottom = 'auto';

      doc.onmousemove = function ( ev ) {
        var x = (ev.clientX - offsetLeft ) + 'px';
        var y = (ev.clientY) + 'px';

        controlsPanel.style.left = x;
        controlsPanel.style.top = y;
      };
    };

    input.onmouseup = function () {
      var styles = getComputedStyle(controlsPanel);
      var left = +styles.left.replace(/px/,'');
      var right = +styles.right.replace(/px/,'');
      var top = +styles.top.replace(/px/,'');
      var bottom = +styles.bottom.replace(/px/,'');

      if ( left > right ) {
        saveLocalStorage('left', 'auto');
        saveLocalStorage('right', styles.right);

        controlsPanel.style.right = styles.right;
        controlsPanel.style.left = 'auto';
      }
      else {
        saveLocalStorage('left', styles.left);
        saveLocalStorage('right', 'auto'); //'auto' needs to override default position;
      }
      if ( top > bottom ) {
        saveLocalStorage('top', 'auto');
        saveLocalStorage('bottom', styles.bottom);

        controlsPanel.style.bottom = styles.bottom;
        controlsPanel.style.top = 'auto';
      }
      else {
        saveLocalStorage('top', styles.top);
        saveLocalStorage('bottom', 'auto');
      }

      doc.onmousemove = null;
    };
  }

  //---------------------------------------------

  function disableInputs() {
    canBeDisabled.forEach(function(item) {
      item.setAttribute('disabled', '');
    });
  }

  //---------------------------------------------

  function enableInputs() {
    canBeDisabled.forEach(function(item) {
      item.removeAttribute('disabled');
    });
  }

  //---------------------------------------------

  function getCurrent(name, defaultValue) {
    var itemName = [prefix, name].join('-');
    var localStorageVal = localStorage[ itemName ];
    return localStorageVal ? localStorageVal : defaultValue;
  }

  //---------------------------------------------

  function saveLocalStorage(name, value) {
    var itemName = [prefix, name].join('-');
    localStorage[itemName] = value;
  }

  //---------------------------------------------

  // Not used
  function getBodyOpacity() {
    var opacityStr = getComputedStyle(doc.body).opacity;
    return +opacityStr;
  }

  //---------------------------------------------

  // Not used
  function addExternalCSS() {
    var styleElem = doc.createElement('style');
    var cssLink = doc.createElement('link');
    cssLink.setAttribute('rel', 'stylesheet');
    cssLink.setAttribute('href', '../pixel-glass-js/styles.css');

    doc.head.appendChild(cssLink);
  }

  //---------------------------------------------

  function applyCurrentData() {
    for (var key in targets ) {
      var target = targets[ key ];
      var current = currents[ key ];

      if (target.attr === 'data') {
        setData( target.elem, key, current );
      }
    }

    if(currents.state === 'off') {
      disableInputs();
    }
  }
  //---------------------------------------------

  function applyCurrentStyles() {
    for (var key in targets ) {
      var target = targets[ key ];
      var current = currents[ key ];

      if (target.attr === 'style') {
        target.elem.style[ key ] = current;
      }
    }
  }

  //---------------------------------------------

  function removeCurrentStyles() {
    for (var key in targets ) {
      var target = targets[ key ];

      if (target.attr === 'style') {
        target.elem.style[ key ] = '';
      }
    }
  }

  //---------------------------------------------

  // Made for IE10, it doesn't support dataset

  function hasData( elem, dataName ) {
    if ( !elem ) {
      return false;
    }

    dataName = 'data-' + dataName;

    if ( elem.getAttribute( dataName) !== undefined && elem.getAttribute( dataName) !== null ) {
      return true;
    }

    return false;
  }

  //---------------------------------------------

  function setData( elem, dataName, dataVal ) {
    if ( !elem ) {
      return;
    }

    dataName = 'data-' + dataName;
    elem.setAttribute( dataName, dataVal );
  }

  //---------------------------------------------

  // Made for IE10, it doesn't support
  // multiply classes for classList.add

  function setClasses( elem, classes ) {
    if ( !elem ) {
      return;
    }

    if ( classes.length > 0 ) {
      classes.forEach( function ( className ) {
        elem.classList.add( className );
      });
    }
  }

  //---------------------------------------------
}

window.onload = function () {
  pixelGlass();
};

!function() {
  'use strict';
  // code
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyIsImNvbW1vbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNqY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHBpeGVsR2xhc3MoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBkb2MgPSBkb2N1bWVudDtcbiAgdmFyIGNvbnRyb2xzUGFuZWw7XG4gIHZhciBib2R5Q29udGVudFdyYXBwZXI7XG4gIHZhciBwYW5lbENsYXNzID0gJ2NvbnRyb2xzLXBhbmVsJztcbiAgdmFyIGNhbkJlRGlzYWJsZWQgPSBbXTtcblxuICB2YXIgcHJlZml4ID0gJ3BnJztcbiAgdmFyIGZpbHRlcnNMaXN0ID0gWydub25lJywgJ2ludmVydCddO1xuICB2YXIgc3RhdGVzTGlzdCA9IFsnb2ZmJywgJ29uJ107XG5cbiAgdmFyIGN1cnJlbnRzID0ge1xuICAgIHN0YXRlOiBnZXRDdXJyZW50KCdzdGF0ZScsIHN0YXRlc0xpc3RbMV0pLFxuICAgIGZpbHRlcjogZ2V0Q3VycmVudCgnZmlsdGVyJywgZmlsdGVyc0xpc3RbMF0pLFxuICAgIG9wYWNpdHk6IGdldEN1cnJlbnQoJ29wYWNpdHknLCAwLjUpXG4gIH07XG5cbiAgdmFyIHRhcmdldHMgPSB7XG4gICAgc3RhdGU6IHtcbiAgICAgIGVsZW06IGRvYy5kb2N1bWVudEVsZW1lbnQsXG4gICAgICBhdHRyOiAnZGF0YSdcbiAgICB9LFxuICAgIGZpbHRlcjoge1xuICAgICAgZWxlbTogZG9jLmJvZHksXG4gICAgICBhdHRyOiAnZGF0YSdcbiAgICB9LFxuICAgIG9wYWNpdHk6IHtcbiAgICAgIGVsZW06IGRvYy5ib2R5LFxuICAgICAgYXR0cjogJ3N0eWxlJ1xuICAgIH1cbiAgfTtcblxuICAvLyBTdGF0ZXMgc3dpdGNoZXIgcGFyYW1zXG4gIHZhciBwYXJhbXNTdGF0ZXMgPSB7XG4gICAgZWxlbVRhZzogJ2J1dHRvbicsXG4gICAgZWxlbVRleHQ6ICdvbicsXG4gICAgbGlzdE5hbWU6ICdzdGF0ZXMnLFxuICAgIGl0ZW1OYW1lOiAnc3RhdGUnLFxuICAgIHRhcmdldDogdGFyZ2V0cy5zdGF0ZSxcbiAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICBsaXN0OiBzdGF0ZXNMaXN0LFxuICAgIGNhbkRpc2FibGVBbGw6IHRydWUsXG4gICAgYXR0cnM6IHtcbiAgICAgIHRhYmluZGV4OiAxLFxuICAgIH1cbiAgfTtcblxuICAvLyBGaWx0ZXJzIHN3aXRjaGVyIHBhcmFtc1xuICB2YXIgcGFyYW1zRmlsdGVycyA9IHtcbiAgICBlbGVtVGFnOiAnYnV0dG9uJyxcbiAgICBlbGVtVGV4dDogJ2ludmVydCcsXG4gICAgbGlzdE5hbWU6ICdmaWx0ZXJzJyxcbiAgICBpdGVtTmFtZTogJ2ZpbHRlcicsXG4gICAgdGFyZ2V0OiB0YXJnZXRzLmZpbHRlcixcbiAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICBsaXN0OiBmaWx0ZXJzTGlzdCxcbiAgICBhdHRyczoge1xuICAgICAgdGFiaW5kZXg6IDIsXG4gICAgfVxuICB9O1xuXG4gIC8vIE9wYWNpdHkgcmFuZ2UgcGFyYW1zXG4gIHZhciBwYXJhbXNPcGFjaXR5ID0ge1xuICAgIGl0ZW1OYW1lOiAnb3BhY2l0eScsXG4gICAgdHlwZTogJ251bWJlcicsXG4gICAgdGFyZ2V0OiB0YXJnZXRzLm9wYWNpdHksXG4gICAgc2V0QXR0cjogJ3N0eWxlJyxcbiAgICBhdHRyczoge1xuICAgICAgbWluOiAwLFxuICAgICAgbWF4OiAxLFxuICAgICAgc3RlcDogMC4xLFxuICAgICAgdGFiaW5kZXg6IDMsXG4gICAgfVxuICB9O1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgaW5pdCgpO1xuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBjcmVhdGVDb250b2xzUGFuZWwoKTtcbiAgICBhcHBseUN1cnJlbnREYXRhKCk7XG5cbiAgICBpZiAoY3VycmVudHMuc3RhdGUgPT09ICdvbicpe1xuICAgICAgYXBwbHlDdXJyZW50U3R5bGVzKCk7XG4gICAgfVxuICB9XG5cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBmdW5jdGlvbiBjcmVhdGVDb250b2xzUGFuZWwoKSB7XG4gICAgdmFyIHRhcmdldEVsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgaWYgKCBoYXNEYXRhKCBkb2MuYm9keSwgJ2hhcy1zdGlja3ktcG9pbnQnICkgKSB7XG4gICAgICB2YXIgc3RpY2t5UG9pbnQgPSBkb2MucXVlcnlTZWxlY3RvcignLnN0aWNreS1wb2ludCcpO1xuXG4gICAgICBpZiggc3RpY2t5UG9pbnQgJiYgIWxvY2FsU3RvcmFnZVsncGctcmVsZWFzZWQnXSApIHtcbiAgICAgICAgdGFyZ2V0RWxlbSA9IHN0aWNreVBvaW50O1xuICAgICAgfVxuICAgICAgLy8gT3ZlcnJpZGUgZGVmYXVsdHMgZm9yIGRlbW8gcGFnZVxuICAgICAgY3VycmVudHMuc3RhdGUgPSAnb2ZmJztcbiAgICB9XG5cbiAgICBjb250cm9sc1BhbmVsID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnRyb2xzUGFuZWwuY2xhc3NMaXN0LmFkZChwYW5lbENsYXNzKTtcbiAgICB0YXJnZXRFbGVtLmFwcGVuZENoaWxkKGNvbnRyb2xzUGFuZWwpO1xuICAgIHZhciBzaWRlcyA9IFsndG9wJywgJ3JpZ2h0JywgJ2JvdHRvbScsICdsZWZ0J107XG5cbiAgICBzaWRlcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHZhciBpdGVtVmFsID0gZ2V0Q3VycmVudChpdGVtLCAnJyk7XG4gICAgICBpZiAoIGl0ZW1WYWwgKSB7XG4gICAgICAgIGNvbnRyb2xzUGFuZWwuc3R5bGVbIGl0ZW0gXSA9IGl0ZW1WYWw7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpbml0Q29udHJvbHMoKTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gaW5pdENvbnRyb2xzKCkge1xuICAgIGNyZWF0ZUJ1dHRvbihwYXJhbXNTdGF0ZXMpO1xuICAgIGNyZWF0ZUJ1dHRvbihwYXJhbXNGaWx0ZXJzKTtcbiAgICBjcmVhdGVJbnB1dE51bWJlcihwYXJhbXNPcGFjaXR5KTtcblxuICAgIGNyZWF0ZURyYWdCdXR0b24oKTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gY3JlYXRlQnV0dG9uKHBhcmFtcykge1xuICAgIHZhciBsaXN0TmFtZSA9IHBhcmFtcy5saXN0TmFtZTtcbiAgICB2YXIgaXRlbU5hbWUgPSBwYXJhbXMuaXRlbU5hbWU7XG4gICAgdmFyIGVsZW1UYWcgPSBwYXJhbXMuZWxlbVRhZztcbiAgICB2YXIgZWxlbVRleHQgPSBwYXJhbXMuZWxlbVRleHQ7XG4gICAgdmFyIHR5cGUgPSBwYXJhbXMudHlwZTtcbiAgICB2YXIgbGlzdCA9IHBhcmFtcy5saXN0O1xuICAgIHZhciBhY3Rpb24gPSBwYXJhbXMuYWN0aW9uO1xuICAgIHZhciBjdXJyZW50VmFsID0gY3VycmVudHNbaXRlbU5hbWVdO1xuICAgIHZhciBhdHRycyA9IHBhcmFtcy5hdHRycztcbiAgICB2YXIgY3VycmVudE51bSA9IGxpc3QuaW5kZXhPZihjdXJyZW50VmFsKTtcbiAgICB2YXIgY2FuRGlzYWJsZUFsbCA9IHBhcmFtcy5jYW5EaXNhYmxlQWxsO1xuXG4gICAgdmFyIGlkID0gaXRlbU5hbWU7XG4gICAgdmFyIGlucHV0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoZWxlbVRhZyk7XG4gICAgc2V0Q2xhc3NlcyggaW5wdXQsIFtcbiAgICAgIHBhbmVsQ2xhc3MgKyAnX19jb250cm9sJyxcbiAgICAgIHBhbmVsQ2xhc3MgKyAnX19jb250cm9sLS0nICsgdHlwZVxuICAgIF0pO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsIHR5cGUpO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG4gICAgc2V0RGF0YSggaW5wdXQsICdzdGF0ZS1udW0nLCBjdXJyZW50TnVtICk7XG5cbiAgICBpZiAoIGF0dHJzICkge1xuICAgICAgZm9yICh2YXIgYXR0ciBpbiBhdHRycykge1xuICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoYXR0ciwgYXR0cnNbYXR0cl0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChlbGVtVGFnID09PSAnYnV0dG9uJykge1xuICAgICAgaW5wdXQuaW5uZXJIVE1MID0gZWxlbVRleHQ7XG4gICAgfVxuXG4gICAgaWYgKCAhY2FuRGlzYWJsZUFsbCApIHtcbiAgICAgIGNhbkJlRGlzYWJsZWQucHVzaChpbnB1dCk7XG4gICAgfVxuXG4gICAgY29udHJvbHNQYW5lbC5hcHBlbmRDaGlsZChpbnB1dCk7XG5cbiAgICBpbnB1dC5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXBhcmFtcy50YXJnZXQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjdXJyZW50TnVtID0gKyFjdXJyZW50TnVtO1xuICAgICAgY3VycmVudFZhbCA9IGxpc3RbY3VycmVudE51bV07XG5cbiAgICAgIHNldERhdGEoIGlucHV0LCAnc3RhdGUtbnVtJywgY3VycmVudE51bSApO1xuICAgICAgc2V0RGF0YSggcGFyYW1zLnRhcmdldC5lbGVtLCBpdGVtTmFtZSwgY3VycmVudFZhbCApO1xuXG4gICAgICBzYXZlTG9jYWxTdG9yYWdlKGl0ZW1OYW1lLCBjdXJyZW50VmFsKTtcblxuICAgICAgaWYgKGNhbkRpc2FibGVBbGwgJiYgY2FuRGlzYWJsZUFsbCA9PT0gdHJ1ZSkge1xuICAgICAgICBpZiAoY3VycmVudFZhbCA9PT0gJ29mZicpe1xuICAgICAgICAgIHJlbW92ZUN1cnJlbnRTdHlsZXMoKTtcbiAgICAgICAgICBkaXNhYmxlSW5wdXRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgYXBwbHlDdXJyZW50U3R5bGVzKCk7XG4gICAgICAgICAgZW5hYmxlSW5wdXRzKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBmdW5jdGlvbiBjcmVhdGVJbnB1dE51bWJlcihwYXJhbXMpIHtcbiAgICB2YXIgaXRlbU5hbWUgPSBwYXJhbXMuaXRlbU5hbWU7XG4gICAgdmFyIGF0dHJzID0gcGFyYW1zLmF0dHJzO1xuICAgIHZhciB0eXBlID0gcGFyYW1zLnR5cGU7XG4gICAgdmFyIHNldEF0dHIgPSBwYXJhbXMuc2V0QXR0cjtcbiAgICB2YXIgY2FuRGlzYWJsZUFsbCA9IHBhcmFtcy5jYW5EaXNhYmxlQWxsO1xuXG4gICAgdmFyIGlkID0gaXRlbU5hbWU7XG4gICAgdmFyIGlucHV0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgc2V0Q2xhc3NlcyggaW5wdXQsIFtcbiAgICAgIHBhbmVsQ2xhc3MgKyAnX19jb250cm9sJyxcbiAgICAgIHBhbmVsQ2xhc3MgKyAnX19jb250cm9sLS0nICsgdHlwZVxuICAgIF0pO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsIHR5cGUpO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG5cbiAgICBmb3IgKHZhciBhdHRyIGluIGF0dHJzKSB7XG4gICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoYXR0ciwgYXR0cnNbYXR0cl0pO1xuICAgIH1cbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgY3VycmVudHNbaXRlbU5hbWVdKTtcblxuICAgIGlmICggIWNhbkRpc2FibGVBbGwgKSB7XG4gICAgICBjYW5CZURpc2FibGVkLnB1c2goaW5wdXQpO1xuICAgIH1cblxuICAgIGNvbnRyb2xzUGFuZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuXG4gICAgaW5wdXQub25pbnB1dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHNldEF0dHIgPT09ICdzdHlsZScpIHtcbiAgICAgICAgcGFyYW1zLnRhcmdldC5lbGVtLnN0eWxlW2l0ZW1OYW1lXSA9IHRoaXMudmFsdWU7XG4gICAgICAgIHNhdmVMb2NhbFN0b3JhZ2UoaXRlbU5hbWUsIHRoaXMudmFsdWUpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZURyYWdCdXR0b24oKSB7XG4gICAgdmFyIGlucHV0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIHNldENsYXNzZXMoIGlucHV0LCBbXG4gICAgICBwYW5lbENsYXNzICsgJ19fY29udHJvbCcsXG4gICAgICBwYW5lbENsYXNzICsgJ19fY29udHJvbC0tZHJhZy1uLWRyb3AnXG4gICAgXSk7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgIGlucHV0LmlubmVySFRNTCA9ICcgJztcblxuICAgIGNvbnRyb2xzUGFuZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuXG4gICAgaW5wdXQub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAvL1BsYWNlIGl0IGhlcmUgdG8gZ2V0IHJlYWwgc2l6ZXMgYWZ0ZXJcbiAgICAgIC8vIGV4dGVybmFsIHN0eWxlcyBoYXMgYmVlbiBsb2FkZWRcbiAgICAgIHZhciBvZmZzZXRUb3AgPSB0aGlzLm9mZnNldFRvcDtcbiAgICAgIHZhciBvZmZzZXRMZWZ0ID0gY29udHJvbHNQYW5lbC5jbGllbnRXaWR0aCAtIHRoaXMuY2xpZW50V2lkdGg7XG4gICAgICB2YXIgc3R5bGVzID0gZ2V0Q29tcHV0ZWRTdHlsZShjb250cm9sc1BhbmVsKTtcblxuICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS50b3AgPSBzdHlsZXMudG9wO1xuICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS5sZWZ0ID0gc3R5bGVzLmxlZnQ7XG4gICAgICBjb250cm9sc1BhbmVsLnN0eWxlLnJpZ2h0ID0gJ2F1dG8nO1xuICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS5ib3R0b20gPSAnYXV0byc7XG5cbiAgICAgIGRvYy5vbm1vdXNlbW92ZSA9IGZ1bmN0aW9uICggZXYgKSB7XG4gICAgICAgIHZhciB4ID0gKGV2LmNsaWVudFggLSBvZmZzZXRMZWZ0ICkgKyAncHgnO1xuICAgICAgICB2YXIgeSA9IChldi5jbGllbnRZKSArICdweCc7XG5cbiAgICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS5sZWZ0ID0geDtcbiAgICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS50b3AgPSB5O1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgaW5wdXQub25tb3VzZXVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHN0eWxlcyA9IGdldENvbXB1dGVkU3R5bGUoY29udHJvbHNQYW5lbCk7XG4gICAgICB2YXIgbGVmdCA9ICtzdHlsZXMubGVmdC5yZXBsYWNlKC9weC8sJycpO1xuICAgICAgdmFyIHJpZ2h0ID0gK3N0eWxlcy5yaWdodC5yZXBsYWNlKC9weC8sJycpO1xuICAgICAgdmFyIHRvcCA9ICtzdHlsZXMudG9wLnJlcGxhY2UoL3B4LywnJyk7XG4gICAgICB2YXIgYm90dG9tID0gK3N0eWxlcy5ib3R0b20ucmVwbGFjZSgvcHgvLCcnKTtcblxuICAgICAgaWYgKCBsZWZ0ID4gcmlnaHQgKSB7XG4gICAgICAgIHNhdmVMb2NhbFN0b3JhZ2UoJ2xlZnQnLCAnYXV0bycpO1xuICAgICAgICBzYXZlTG9jYWxTdG9yYWdlKCdyaWdodCcsIHN0eWxlcy5yaWdodCk7XG5cbiAgICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS5yaWdodCA9IHN0eWxlcy5yaWdodDtcbiAgICAgICAgY29udHJvbHNQYW5lbC5zdHlsZS5sZWZ0ID0gJ2F1dG8nO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNhdmVMb2NhbFN0b3JhZ2UoJ2xlZnQnLCBzdHlsZXMubGVmdCk7XG4gICAgICAgIHNhdmVMb2NhbFN0b3JhZ2UoJ3JpZ2h0JywgJ2F1dG8nKTsgLy8nYXV0bycgbmVlZHMgdG8gb3ZlcnJpZGUgZGVmYXVsdCBwb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIGlmICggdG9wID4gYm90dG9tICkge1xuICAgICAgICBzYXZlTG9jYWxTdG9yYWdlKCd0b3AnLCAnYXV0bycpO1xuICAgICAgICBzYXZlTG9jYWxTdG9yYWdlKCdib3R0b20nLCBzdHlsZXMuYm90dG9tKTtcblxuICAgICAgICBjb250cm9sc1BhbmVsLnN0eWxlLmJvdHRvbSA9IHN0eWxlcy5ib3R0b207XG4gICAgICAgIGNvbnRyb2xzUGFuZWwuc3R5bGUudG9wID0gJ2F1dG8nO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNhdmVMb2NhbFN0b3JhZ2UoJ3RvcCcsIHN0eWxlcy50b3ApO1xuICAgICAgICBzYXZlTG9jYWxTdG9yYWdlKCdib3R0b20nLCAnYXV0bycpO1xuICAgICAgfVxuXG4gICAgICBkb2Mub25tb3VzZW1vdmUgPSBudWxsO1xuICAgIH07XG4gIH1cblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGZ1bmN0aW9uIGRpc2FibGVJbnB1dHMoKSB7XG4gICAgY2FuQmVEaXNhYmxlZC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gZW5hYmxlSW5wdXRzKCkge1xuICAgIGNhbkJlRGlzYWJsZWQuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICBpdGVtLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gZ2V0Q3VycmVudChuYW1lLCBkZWZhdWx0VmFsdWUpIHtcbiAgICB2YXIgaXRlbU5hbWUgPSBbcHJlZml4LCBuYW1lXS5qb2luKCctJyk7XG4gICAgdmFyIGxvY2FsU3RvcmFnZVZhbCA9IGxvY2FsU3RvcmFnZVsgaXRlbU5hbWUgXTtcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlVmFsID8gbG9jYWxTdG9yYWdlVmFsIDogZGVmYXVsdFZhbHVlO1xuICB9XG5cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBmdW5jdGlvbiBzYXZlTG9jYWxTdG9yYWdlKG5hbWUsIHZhbHVlKSB7XG4gICAgdmFyIGl0ZW1OYW1lID0gW3ByZWZpeCwgbmFtZV0uam9pbignLScpO1xuICAgIGxvY2FsU3RvcmFnZVtpdGVtTmFtZV0gPSB2YWx1ZTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gTm90IHVzZWRcbiAgZnVuY3Rpb24gZ2V0Qm9keU9wYWNpdHkoKSB7XG4gICAgdmFyIG9wYWNpdHlTdHIgPSBnZXRDb21wdXRlZFN0eWxlKGRvYy5ib2R5KS5vcGFjaXR5O1xuICAgIHJldHVybiArb3BhY2l0eVN0cjtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gTm90IHVzZWRcbiAgZnVuY3Rpb24gYWRkRXh0ZXJuYWxDU1MoKSB7XG4gICAgdmFyIHN0eWxlRWxlbSA9IGRvYy5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgIHZhciBjc3NMaW5rID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICBjc3NMaW5rLnNldEF0dHJpYnV0ZSgncmVsJywgJ3N0eWxlc2hlZXQnKTtcbiAgICBjc3NMaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsICcuLi9waXhlbC1nbGFzcy1qcy9zdHlsZXMuY3NzJyk7XG5cbiAgICBkb2MuaGVhZC5hcHBlbmRDaGlsZChjc3NMaW5rKTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gYXBwbHlDdXJyZW50RGF0YSgpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gdGFyZ2V0cyApIHtcbiAgICAgIHZhciB0YXJnZXQgPSB0YXJnZXRzWyBrZXkgXTtcbiAgICAgIHZhciBjdXJyZW50ID0gY3VycmVudHNbIGtleSBdO1xuXG4gICAgICBpZiAodGFyZ2V0LmF0dHIgPT09ICdkYXRhJykge1xuICAgICAgICBzZXREYXRhKCB0YXJnZXQuZWxlbSwga2V5LCBjdXJyZW50ICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYoY3VycmVudHMuc3RhdGUgPT09ICdvZmYnKSB7XG4gICAgICBkaXNhYmxlSW5wdXRzKCk7XG4gICAgfVxuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gYXBwbHlDdXJyZW50U3R5bGVzKCkge1xuICAgIGZvciAodmFyIGtleSBpbiB0YXJnZXRzICkge1xuICAgICAgdmFyIHRhcmdldCA9IHRhcmdldHNbIGtleSBdO1xuICAgICAgdmFyIGN1cnJlbnQgPSBjdXJyZW50c1sga2V5IF07XG5cbiAgICAgIGlmICh0YXJnZXQuYXR0ciA9PT0gJ3N0eWxlJykge1xuICAgICAgICB0YXJnZXQuZWxlbS5zdHlsZVsga2V5IF0gPSBjdXJyZW50O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gcmVtb3ZlQ3VycmVudFN0eWxlcygpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gdGFyZ2V0cyApIHtcbiAgICAgIHZhciB0YXJnZXQgPSB0YXJnZXRzWyBrZXkgXTtcblxuICAgICAgaWYgKHRhcmdldC5hdHRyID09PSAnc3R5bGUnKSB7XG4gICAgICAgIHRhcmdldC5lbGVtLnN0eWxlWyBrZXkgXSA9ICcnO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gTWFkZSBmb3IgSUUxMCwgaXQgZG9lc24ndCBzdXBwb3J0IGRhdGFzZXRcblxuICBmdW5jdGlvbiBoYXNEYXRhKCBlbGVtLCBkYXRhTmFtZSApIHtcbiAgICBpZiAoICFlbGVtICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGRhdGFOYW1lID0gJ2RhdGEtJyArIGRhdGFOYW1lO1xuXG4gICAgaWYgKCBlbGVtLmdldEF0dHJpYnV0ZSggZGF0YU5hbWUpICE9PSB1bmRlZmluZWQgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoIGRhdGFOYW1lKSAhPT0gbnVsbCApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gc2V0RGF0YSggZWxlbSwgZGF0YU5hbWUsIGRhdGFWYWwgKSB7XG4gICAgaWYgKCAhZWxlbSApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkYXRhTmFtZSA9ICdkYXRhLScgKyBkYXRhTmFtZTtcbiAgICBlbGVtLnNldEF0dHJpYnV0ZSggZGF0YU5hbWUsIGRhdGFWYWwgKTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gTWFkZSBmb3IgSUUxMCwgaXQgZG9lc24ndCBzdXBwb3J0XG4gIC8vIG11bHRpcGx5IGNsYXNzZXMgZm9yIGNsYXNzTGlzdC5hZGRcblxuICBmdW5jdGlvbiBzZXRDbGFzc2VzKCBlbGVtLCBjbGFzc2VzICkge1xuICAgIGlmICggIWVsZW0gKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCBjbGFzc2VzLmxlbmd0aCA+IDAgKSB7XG4gICAgICBjbGFzc2VzLmZvckVhY2goIGZ1bmN0aW9uICggY2xhc3NOYW1lICkge1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoIGNsYXNzTmFtZSApO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbn1cblxud2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgcGl4ZWxHbGFzcygpO1xufTtcbiIsIiFmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvLyBjb2RlXG59KCk7XG4iXX0=
